<div class="flex justify-between w-full flex-gap">
  <h1 class="text-2xl">All users</h1>
</div>
  <h1> Meilisearch </h1>
    <div>
      <div id="searchbox"></div>
      <div id="hits"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@meilisearch/instant-meilisearch/dist/instant-meilisearch.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4"></script>
<script type="text/javascript">

const search = instantsearch({
  indexName: 'User',
  searchClient: instantMeiliSearch(
    'http://127.0.0.1:7700'
  ),
})

search.addWidgets([
  instantsearch.widgets.searchBox({
    container: '#searchbox',
  }),
  instantsearch.widgets.hits({
    container: '#hits',
    templates: {
      item: `
        <div>
          <div class="hit-name">
            {{#helpers.highlight}}{ "attribute": "name" }{{/helpers.highlight}}
          </div>
        </div>
      `,
    },
  }),
])

search.start()
</script>


<%= form_with url: filter_people_path, method: :post do |form| %>
  <div class="flex justify-between w-full mt-4 flex-gap">
    <div>
      <div class="relative text-gray-400 focus-within:text-gray-400">
        <div class="absolute inset-y-0 left-0 flex items-center pl-2 pointer-events-none">
          <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
          </svg>
        </div>
        <%= form.text_field :query, placeholder: 'Search contact', class: 'block w-full py-2 pl-10 pr-3 leading-5 text-indigo-100 placeholder-gray-400 border border-transparent rounded-md cursor-not-allowed bg-gray-50 focus:outline-none focus:bg-white focus:ring-0 focus:placeholder-gray-400 focus:text-gray-900 sm:text-sm' %>
      </div>
    </div>
    <div>
      <div class="relative inline-block px-4 text-left" x-data="{open: false}">
        <button @click="open = !open" type="button" class="inline-flex justify-center text-sm font-medium text-gray-700 group hover:text-gray-900" aria-expanded="false">
          <span>Tags</span>
          <% if params[:tag] %>
          <span class="ml-1.5 rounded py-0.5 px-1.5 bg-gray-200 text-xs font-semibold text-gray-700 tabular-nums">
            <%#= params[:tag] %>
          </span>
          <% end %>
          <svg class="flex-shrink-0 w-5 h-5 ml-1 -mr-1 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
        </button>
        <div
          x-show="open"
          x-transition
          x-on:click.away="open = false"
        >
          <div class="absolute right-0 p-4 mt-2 origin-top-right bg-white rounded-md shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none">
              <%= form.collection_check_boxes :tag_ids, Tag.all, :id, :name do |b| %>
                <div class="flex items-center">
                  <%= b.check_box %>
                  <label for="filter-category-0" class="pr-6 ml-3 text-sm font-medium text-gray-900 whitespace-nowrap">
                    <%= b.label %>
                  </label>
                </div>
              <% end %>
          </div>
        </div>
      </div>
      <%= form.submit "Search" %>
    </div>
  </div>
<% end %>

<% if !@users.empty? %>
  <div class="grid grid-cols-3 gap-4 mt-4">
  <% @users.each do |user| %>
      <div class="flex-auto px-4 py-4 bg-white rounded-md">
        <div class="flex items-center">
          <%# Image here %>
          <div class="">
            <%= link_to user.name, profile_path(user.slug) %><br/>
            <a href="mailto:<% user.email %>" class="text-sm text-gray-400"><%= user.email %></a>
          </div>
        </div>
        <% if user.tags.present? %>
          <div class="py-4">
            <h4 class="text-gray-800">Creative fields</h4>
            <div class="flex justify-between mt-1">
              <div class="flex space-x-2">
                <% user.tags.each do |tag| %>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-md text-xs font-medium bg-gray-100 text-gray-400">
                      <%= tag.name %>
                    </span>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
        </div>
    <% end %>
  </div>
<% else %>
    <h1> Weird, niemand gevonden... </h1>
<% end %>

