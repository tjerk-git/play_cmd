<div class="flex justify-between w-full flex-gap">
  <h1 class="text-2xl">Listing all posts
    <% if params[:tag] %>
      with tag
      <span class="font-bold">
       <%= params[:tag] %>
      </span>
    <% end %>
  </h1>
  <div class="flex items-center -mx-4 divide-x divide-gray-200">
    <div class="relative inline-block px-4 text-left" x-data="{open: false}">
      <button @click="open = !open" type="button" class="inline-flex justify-center text-sm font-medium text-gray-700 group hover:text-gray-900" aria-expanded="false">
        <span>Tags</span>
        <% if params[:tag] %>
          <span class="ml-1.5 rounded py-0.5 px-1.5 bg-gray-200 text-xs font-semibold text-gray-700 tabular-nums">
            <%#= params[:tag] %>
          </span>
        <% end %>
        <svg class="flex-shrink-0 w-5 h-5 ml-1 -mr-1 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
          <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
        </svg>
      </button>
      <div
        x-show="open"
        x-transition
        x-on:click.away="open = false"
      >
        <div class="absolute right-0 p-4 mt-2 origin-top-right bg-white rounded-md shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none">
          <%= form_with model: @post, url: filter_posts_path do |form| %>
            <%= form.collection_check_boxes :tag_ids, Tag.all, :id, :name do |b| %>
              <div class="flex items-center">
                <%= b.check_box %>
                <label for="filter-category-0" class="pr-6 ml-3 text-sm font-medium text-gray-900 whitespace-nowrap">
                  <%= b.label %>
                </label>
              </div>
            <% end %>
            <%= form.submit %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="my-2 bg-gray-100">
  <% if @posts %>
    <div class="grid grid-cols-3 gap-4 mt-4">
      <% @posts.each do |post| %>
        <div class="bg-white rounded-md shadow-md">
          <div>
            <% if post.images.attached? %>
              <% post.images.each do |image| %>
                <%= link_to gallery_view_path do %>
                  <%= image_tag image.variant(resize_to_limit: [800, 400]).processed %>
                <% end %>
              <% end %>
            <% end %>
          </div>
          <header class="flex p-2 md:p-4">
            <div>
              <h2 class="text-2xl font-bold hover:underline"><%= link_to post.title, post_path(post.slug) %></h2>
            </div>
          </header>
          <% if post.tags.present? %>
            <div class="bottom-0 flex justify-between p-2 pb-4 space-x-8 md:px-4">
              <div class="flex space-x-2">
                <% post.tags.each do |tag| %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-md text-xs font-medium bg-gray-100 text-gray-400">
              <%= link_to tag.name, "/posts/list/#{tag.name}" %>
            </span>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  <% else %>
    <h1> No posts found... </h1>
  <% end %>
</div>